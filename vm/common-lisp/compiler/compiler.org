#+TITLE:  compiler
#+AUTHOR: 謝宇恆 / XIE Yuheng
#+EMAIL:  xyheme@gmail.com

* ===================================
* note
* -----------------------------------
* file header
** compiler.lisp
   #+begin_src lisp :tangle compiler.lisp
   (in-package :cicada-vm)
   #+end_src
** compiler.test.lisp
   #+begin_src lisp :tangle compiler.test.lisp
   (in-package :cicada-vm)
   #+end_src
* -----------------------------------
* compiler of cicada language
** 記
   * 這裏的編譯器是將要被重新實現於蟬語中的
     所以
     其代碼風格趨向蟬語
   * 注意所處理的都是字符串 而不是 stream
   * 難點在於
     在這裏就要形成 所謂的 語境 概念
     所定義的是一個語境而已
     這個語境中 保留了 forth 的語法的傳統
     但是這裏不能使用虛擬機中的 姓名 機制來實現 語境
     也沒有必要這樣做
     因爲這裏的語境是單一的
** note usage in common-lisp
   * [ (: cicada :) ]
** cicada
   #+begin_src lisp :tangle compiler.lisp
   (defun cicada (string) (cicada-language string))
   (defun cicada-language (string)
     (string->list#word string))
   #+end_src
** key-word
** test
   #+begin_src cicada
   [ (: cicada :)

   : string->char
     (* string[address, length] -- char *)
     (* drop fetch-byte *)
     get-char
     xx|swap|x drop2
     Exit
   ; define-verb

   : <string> (->char)
     (@ <string> -- <char> @)
     (char) (* drop fetch-byte *)
     (xx|swap|x) (drop 2)
   ; (define-verb)

   : <string> ->char
     (@ <string> -- <char> @)
     char (* drop fetch-byte *)
     xx|swap|x drop2
   ; define-verb

   ]
   #+end_src
* -----------------------------------
* vector-function
** ----------------------------------
** 記
   * 函數體 中所保存的是線串碼[threaded-code][一串珠]
     也可以說一個函數體就是被線穿起來的一串珠子[bead]
     每個珠子是兩個物 一爲指令 二爲指令之參數
     不同的指令的參數個數可以不同 也就是說珠子有大有小
   * 函數頭 中保存約束變元的信息 還有返回值的信息 還有其他信息
** ----------------------------------
** fetch & save
   #+begin_src lisp :tangle compiler.lisp
   (defun fetch#vector-function-body ())
   (defun save#vector-function-body ())
   #+end_src
** ----------------------------------
* ===================================
